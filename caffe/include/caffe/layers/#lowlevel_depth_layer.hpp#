#ifndef CAFFE_LOWLEVEL_DISTANCE_LAYER_HPP_
#define CAFFE_LOWLEVEL_DISTANCE_LAYER_HPP_

#include <utility>
#include <vector>

file:///home/shi137/riku/RGBD1000+/TEST/gt/1_02-02-40.png file:///home/shi137/riku/RGBD1000+/TEST/gt/1_02-14-09.png file:///home/shi137/riku/RGBD1000+/TEST/gt/1_03-06-41.png file:///home/shi137/riku/RGBD1000+/TEST/gt/1_03-11-59.png file:///home/shi137/riku/RGBD1000+/TEST/gt/1_03-32-45.png file:///home/shi137/riku/RGBD1000+/TEST/gt/1_03-33-28.png file:///home/shi137/riku/RGBD1000+/TEST/gt/1_10-38-55.png file:///home/shi137/riku/RGBD1000+/TEST/gt/1_10-39-51.png file:///home/shi137/riku/RGBD1000+/TEST/gt/2_06-37-14.png file:///home/shi137/riku/RGBD1000+/TEST/gt/2_06-49-36.png file:///home/shi137/riku/RGBD1000+/TEST/gt/2_07-14-29.png file:///home/shi137/riku/RGBD1000+/TEST/gt/2_07-30-36.png file:///home/shi137/riku/RGBD1000+/TEST/gt/3_09-50-40.png file:///home/shi137/riku/RGBD1000+/TEST/gt/3_09-50-51.png file:///home/shi137/riku/RGBD1000+/TEST/gt/3_09-51-22.png file:///home/shi137/riku/RGBD1000+/TEST/gt/3_09-53-21.png file:///home/shi137/riku/RGBD1000+/TEST/gt/3_10-14-07.png file:///home/shi137/riku/RGBD1000+/TEST/gt/3_10-24-25.png file:///home/shi137/riku/RGBD1000+/TEST/gt/3_10-25-01.png file:///home/shi137/riku/RGBD1000+/TEST/gt/3_10-42-10.png file:///home/shi137/riku/RGBD1000+/TEST/gt/3_10-47-54.png file:///home/shi137/riku/RGBD1000+/TEST/gt/3_10-48-00.png file:///home/shi137/riku/RGBD1000+/TEST/gt/4_04-14-11.png file:///home/shi137/riku/RGBD1000+/TEST/gt/4_04-25-12.png file:///home/shi137/riku/RGBD1000+/TEST/gt/4_05-33-06.png file:///home/shi137/riku/RGBD1000+/TEST/gt/4_06-41-47.png file:///home/shi137/riku/RGBD1000+/TEST/gt/4_06-42-40.png file:///home/shi137/riku/RGBD1000+/TEST/gt/4_06-55-06.png file:///home/shi137/riku/RGBD1000+/TEST/gt/4_07-11-40.png file:///home/shi137/riku/RGBD1000+/TEST/gt/4_07-26-30.png file:///home/shi137/riku/RGBD1000+/TEST/gt/4_07-27-16.png file:///home/shi137/riku/RGBD1000+/TEST/gt/4_07-29-03.png file:///home/shi137/riku/RGBD1000+/TEST/gt/5_06-39-00.png file:///home/shi137/riku/RGBD1000+/TEST/gt/5_06-44-12.png file:///home/shi137/riku/RGBD1000+/TEST/gt/5_07-36-08.png file:///home/shi137/riku/RGBD1000+/TEST/gt/5_07-37-32.png file:///home/shi137/riku/RGBD1000+/TEST/gt/5_07-40-22.png file:///home/shi137/riku/RGBD1000+/TEST/gt/5_08-14-10.png file:///home/shi137/riku/RGBD1000+/TEST/gt/6_04-53-56.png file:///home/shi137/riku/RGBD1000+/TEST/gt/6_05-01-08.png file:///home/shi137/riku/RGBD1000+/TEST/gt/6_05-03-01.png file:///home/shi137/riku/RGBD1000+/TEST/gt/6_06-38-11.png file:///home/shi137/riku/RGBD1000+/TEST/gt/6_06-39-48.png file:///home/shi137/riku/RGBD1000+/TEST/gt/6_07-05-25.png file:///home/shi137/riku/RGBD1000+/TEST/gt/6_07-17-34.png file:///home/shi137/riku/RGBD1000+/TEST/gt/6_07-19-03.png file:///home/shi137/riku/RGBD1000+/TEST/gt/6_07-19-32.png file:///home/shi137/riku/RGBD1000+/TEST/gt/6_07-23-28.png file:///home/shi137/riku/RGBD1000+/TEST/gt/6_07-26-15.png file:///home/shi137/riku/RGBD1000+/TEST/gt/6_07-28-21.png file:///home/shi137/riku/RGBD1000+/TEST/gt/6_07-32-30.png file:///home/shi137/riku/RGBD1000+/TEST/gt/6_07-44-36.png file:///home/shi137/riku/RGBD1000+/TEST/gt/6_07-54-05.png file:///home/shi137/riku/RGBD1000+/TEST/gt/7_06-37-05.png file:///home/shi137/riku/RGBD1000+/TEST/gt/7_06-46-40.png file:///home/shi137/riku/RGBD1000+/TEST/gt/7_06-54-32.png file:///home/shi137/riku/RGBD1000+/TEST/gt/7_06-59-03.png file:///home/shi137/riku/RGBD1000+/TEST/gt/7_07-05-46.png file:///home/shi137/riku/RGBD1000+/TEST/gt/7_07-06-39.png file:///home/shi137/riku/RGBD1000+/TEST/gt/7_07-07-08.png file:///home/shi137/riku/RGBD1000+/TEST/gt/7_07-19-33.png file:///home/shi137/riku/RGBD1000+/TEST/gt/7_07-25-16.png file:///home/shi137/riku/RGBD1000+/TEST/gt/7_07-47-01.png file:///home/shi137/riku/RGBD1000+/TEST/gt/7_07-58-37.png file:///home/shi137/riku/RGBD1000+/TEST/gt/7_07-58-43.png file:///home/shi137/riku/RGBD1000+/TEST/gt/7_08-14-28.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-20-01.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-22-34.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-23-20.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-24-52.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-25-13.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-25-40.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-27-10.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-28-02.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-29-00.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-29-12.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-29-38.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-31-31.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-34-35.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-34-56.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-36-01.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-37-02.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-37-21.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-39-10.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-40-51.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-41-58.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-44-50.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-45-40.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-46-12.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-47-15.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-48-29.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_08-49-30.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_10-41-01.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_10-45-46.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_10-46-24.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_10-48-13.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_11-07-36.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_11-09-13.png file:///home/shi137/riku/RGBD1000+/TEST/gt/8_11-11-20.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_01-13-17.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_01-20-23.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_01-31-18.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_01-34-03.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_01-36-52.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_01-38-16.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_01-45-08.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_02-08-48.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_02-16-57.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_02-26-09.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_02-26-49.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_02-29-37.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_03-15-26.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_03-17-27.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_03-25-21.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_03-30-03.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_03-31-59.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_03-43-11.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_03-43-31.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_03-44-51.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_03-46-43.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_03-46-59.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_03-47-07.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_07-35-51.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_07-39-33.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_07-41-17.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_07-44-08.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_07-44-59.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_07-46-41.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_07-47-38.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_07-47-50.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_07-48-04.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_07-51-23.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_07-53-04.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_08-00-38.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_12-36-52.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_12-37-52.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_12-42-09.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_12-43-07.png file:///home/shi137/riku/RGBD1000+/TEST/gt/9_12-49-39.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-00-02.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-01-03.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-02-50.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-03-41.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-04-00.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-05-05.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-05-11.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-07-42.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-08-19.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-11-34.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-16-36.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-16-50.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-17-12.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-17-25.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-17-42.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-18-50.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-21-12.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_01-30-24.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_02-58-32.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_02-58-38.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_02-58-59.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_02-59-15.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-02-33.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-03-30.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-03-56.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-07-13.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-07-35.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-08-08.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-09-03.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-09-22.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-10-33.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-21-10.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-24-01.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-24-30.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-25-10.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-25-23.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-25-34.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-26-56.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-27-11.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-27-23.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-27-50.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-29-54.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_03-31-00.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_09-28-10.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_09-29-58.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_09-30-51.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_09-32-19.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_09-34-29.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_09-36-44.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_09-37-38.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_09-43-10.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_09-44-33.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_09-49-49.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_09-50-19.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_09-52-22.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_09-56-44.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-07-43.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-07-49.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-10-15.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-18-45.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-19-31.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-22-32.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-23-20.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-26-22.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-38-21.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-38-32.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-43-13.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-44-11.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-44-15.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-46-02.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-46-57.png file:///home/shi137/riku/RGBD1000+/TEST/gt/10_12-59-25.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-44-41.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-45-58.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-47-14.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-47-17.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-47-24.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-47-32.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-48-18.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-48-39.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-51-12.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-51-59.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-52-08.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-53-12.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-54-51.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-55-51.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-57-01.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_03-57-27.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_04-00-00.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_04-01-13.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_04-01-27.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_04-07-13.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_04-07-29.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_04-08-22.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_04-09-12.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_04-10-12.png file:///home/shi137/riku/RGBD1000+/TEST/gt/11_04-18-55.png file:///home/shi137/riku/RGBD1000+/TEST/gt/12_03-50-35.png file:///home/shi137/riku/RGBD1000+/TEST/gt/12_03-54-13.png file:///home/shi137/riku/RGBD1000+/TEST/gt/12_03-54-37.png file:///home/shi137/riku/RGBD1000+/TEST/gt/12_03-55-39.png file:///home/shi137/riku/RGBD1000+/TEST/gt/12_03-56-13.png file:///home/shi137/riku/RGBD1000+/TEST/gt/12_03-56-44.png file:///home/shi137/riku/RGBD1000+/TEST/gt/12_04-08-01.png file:///home/shi137/riku/RGBD1000+/TEST/gt/12_04-08-35.png file:///home/shi137/riku/RGBD1000+/TEST/gt/12_04-17-45.png file:///home/shi137/riku/RGBD1000+/TEST/gt/12_04-18-19.png file:///home/shi137/riku/RGBD1000+/TEST/gt/12_04-24-15.png file:///home/shi137/riku/RGBD1000+/TEST/gt/12_04-24-53.png file:///home/shi137/riku/RGBD1000+/TEST/gt/12_04-25-12.png file:///home/shi137/riku/RGBD1000+/TEST/gt/#include "caffe/blob.hpp"
#include "caffe/layer.hpp"
#include "caffe/proto/caffe.pb.h"
#include "ORUtils/gSLICr_defines.h"
using namespace gSLICr;

namespace caffe {

template <typename Dtype>
class LowlevelDepthLayer : public Layer<Dtype> {
 public:
  explicit LowlevelDepthLayer(const LayerParameter& param) :
    Layer<Dtype>(param), dim_output_(0) {}
  virtual void Reshape(const vector<Blob<Dtype>*>& bottom,
      const vector<Blob<Dtype>*>& top);
  virtual inline const char* type() const { return "LowlevelDepth"; }
  // input : data, slic_index, dead pixel map(superpixel num), (label_map)
  virtual inline int MinBottomBlobs() const { return 3; }
  // output : (N*R)*C*H*W[initial distance maps], (N*R) [labels]
  virtual inline int ExactNumTopBlobs() const { return 1; }

 protected:
  virtual void Forward_cpu(const vector<Blob<Dtype>*>& bottom,
      const vector<Blob<Dtype>*>& top) {
      NOT_IMPLEMENTED;
  }
  virtual void Forward_gpu(const vector<Blob<Dtype>*>& bottom,
      const vector<Blob<Dtype>*>& top);
  
  virtual void Backward_cpu(const vector<Blob<Dtype>*>& top,
      const vector<bool>& propagate_down, const vector<Blob<Dtype>*>& bottom) {
      NOT_IMPLEMENTED;
  }

  virtual void Backward_gpu(const vector<Blob<Dtype>*>& top,
      const vector<bool>& propagate_down, const vector<Blob<Dtype>*>& bottom) {
      // pass
  }
  void PickQueryRegions(const Blob<Dtype>* dead_spmap);

  int dim_output_; // Dimension of the initial distance features
  int sp_size_;

  Blob<Depthcrafted> grid_features_; // N * 1 * G * G
  Blob<Depthcrafted> query_features_; // N * R
  Blob<float> query_region_indexes_; // N * R 
  int grid_size_;
  int R_; // the number of query regions per an image.
  int N_;
  int H_;
  int W_;

};

} // namespace caffe

#endif // CAFFE_LOWLEVEL_DISTANCE_LAYER_HPP_
